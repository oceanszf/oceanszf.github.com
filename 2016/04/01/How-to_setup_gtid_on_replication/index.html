<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>How-to setup gtid on replication | Suzf Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="准备工作Mysql 单机多实例详解What is the GTID of the replication
实验环境Os: CentOS 6.XMysql: 5.6 单机多实例 [3306,3307]Hostname: lab.suzf.net
场景一：新机器 无数据##### 
对于GTID的配置，主要修改配置文件中与GTID特性相关的几个重要参数">
<meta property="og:type" content="article">
<meta property="og:title" content="How-to setup gtid on replication">
<meta property="og:url" content="http://blog.suzf.net/2016/04/01/How-to_setup_gtid_on_replication/index.html">
<meta property="og:site_name" content="Suzf Blog">
<meta property="og:description" content="准备工作Mysql 单机多实例详解What is the GTID of the replication
实验环境Os: CentOS 6.XMysql: 5.6 单机多实例 [3306,3307]Hostname: lab.suzf.net
场景一：新机器 无数据##### 
对于GTID的配置，主要修改配置文件中与GTID特性相关的几个重要参数">
<meta property="og:image" content="http://suzf.net/wp-content/uploads/2016/04/gtid1.png">
<meta property="og:image" content="http://suzf.net/wp-content/uploads/2016/04/innobackup.png">
<meta property="og:updated_time" content="2016-04-29T12:43:02.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="How-to setup gtid on replication">
<meta name="twitter:description" content="准备工作Mysql 单机多实例详解What is the GTID of the replication
实验环境Os: CentOS 6.XMysql: 5.6 单机多实例 [3306,3307]Hostname: lab.suzf.net
场景一：新机器 无数据##### 
对于GTID的配置，主要修改配置文件中与GTID特性相关的几个重要参数">
  
    <link rel="alternative" href="/atom.xml" title="Suzf Blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/style.css" type="text/css">
  

</head>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Suzf Blog</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">Life is short, We need smile.</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://blog.suzf.net"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-How-to_setup_gtid_on_replication" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/04/01/How-to_setup_gtid_on_replication/" class="article-date">
  <time datetime="2016-04-01T06:41:02.000Z" itemprop="datePublished">2016-04-01</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Mysql/">Mysql</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      How-to setup gtid on replication
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="u51C6_u5907_u5DE5_u4F5C"><a href="#u51C6_u5907_u5DE5_u4F5C" class="headerlink" title="准备工作"></a>准备工作</h3><p><a href="http://suzf.net/thread-1202-555.html" target="_blank" rel="external">Mysql 单机多实例详解</a><br><a href="http://suzf.net/thread-0401-693.html" target="_blank" rel="external">What is the GTID of the replication</a></p>
<h3 id="u5B9E_u9A8C_u73AF_u5883"><a href="#u5B9E_u9A8C_u73AF_u5883" class="headerlink" title="实验环境"></a>实验环境</h3><p>Os: CentOS 6.X<br>Mysql: 5.6 单机多实例 [3306,3307]<br>Hostname: lab.suzf.net</p>
<h5 id="u573A_u666F_u4E00_uFF1A_u65B0_u673A_u5668__u65E0_u6570_u636E"><a href="#u573A_u666F_u4E00_uFF1A_u65B0_u673A_u5668__u65E0_u6570_u636E" class="headerlink" title="场景一：新机器 无数据"></a>场景一：新机器 无数据</h5><p>##### </p>
<p>对于GTID的配置，主要修改配置文件中与GTID特性相关的几个重要参数<a id="more"></a></p>
<p><pre class="lang:default decode:true ">[mysqld_multi]<br>mysqld = /usr/local/mysql/bin/mysqld_safe<br>mysqladmin = /usr/local/mysql/bin/mysqladmin<br>log = /usr/local/mysql/data/log/mysqld_multi.log<br>user = root ## Used for stopping the server via mysqladmin</pre></p>
<h1 id="master"><a href="#master" class="headerlink" title="master"></a>master</h1><p>[mysqld3306]<br>socket = /usr/local/mysql/data/run/mysqld_3306.sock<br>port = 3306<br>pid-file = /usr/local/mysql/data/run/mysqld_3306.pid<br>datadir = /usr/local/mysql/data/mysql_3306</p>
<h1 id="set_for_GTID_Replication"><a href="#set_for_GTID_Replication" class="headerlink" title="set for GTID Replication"></a>set for GTID Replication</h1><p>server_id = 3232237894<br>gtid_mode = on<br>enforce_gtid_consistency = on  #强制gtid一致性，开启后对于特定create table不被支持</p>
<h1 id="binlog"><a href="#binlog" class="headerlink" title="binlog"></a>binlog</h1><p>log-bin = /usr/local/mysql/data/binlogs/master-binlog<br>log-slave-updates = 1<br>binlog_format = row            #强烈建议，其他格式可能造成数据不一致</p>
<h1 id="rely_log"><a href="#rely_log" class="headerlink" title="rely log"></a>rely log</h1><p>skip_slave_start=1</p>
<h1 id="slave"><a href="#slave" class="headerlink" title="slave"></a>slave</h1><p>[mysqld3307]<br>socket = /usr/local/mysql/data/run/mysqld_3307.sock<br>port = 3307<br>pid-file = /usr/local/mysql/data/run/mysqld_3307.pid<br>datadir = /usr/local/mysql/data/mysql_3307</p>
<h1 id="set_for_GTID_Replication-1"><a href="#set_for_GTID_Replication-1" class="headerlink" title="set for GTID Replication"></a>set for GTID Replication</h1><p>server_id = 3232237866<br>gtid_mode = on<br>enforce_gtid_consistency = on</p>
<h1 id="bin_log"><a href="#bin_log" class="headerlink" title="bin log"></a>bin log</h1><p>log-bin = /usr/local/mysql/data/binlogs/slave-binlog<br>log-slave-updates = 1<br>binlog_format = row</p>
<h1 id="rely_log-1"><a href="#rely_log-1" class="headerlink" title="rely log"></a>rely log</h1><p>skip_slave_start=1</p>
<p>[client]<br>default-character-set = utf8<br><strong>重启mysql</strong><br>/etc/init.d/mysqld_multi.server restart</p>
<p><strong>Mysql 多实例启动脚本</strong></p>
<p><pre class="lang:default decode:true ">cat /etc/init.d/mysqld_multi.server</pre></p>
<p>#!/bin/sh<br>#</p>
<h1 id="A_simple_startup_script_for_mysqld_multi_by_Tim_Smith_and_Jani_Tolonen"><a href="#A_simple_startup_script_for_mysqld_multi_by_Tim_Smith_and_Jani_Tolonen" class="headerlink" title="A simple startup script for mysqld_multi by Tim Smith and Jani Tolonen."></a>A simple startup script for mysqld_multi by Tim Smith and Jani Tolonen.</h1><h1 id="This_script_assumes_that_my-cnf_file_exists_either_in_/etc/my-cnf_or"><a href="#This_script_assumes_that_my-cnf_file_exists_either_in_/etc/my-cnf_or" class="headerlink" title="This script assumes that my.cnf file exists either in /etc/my.cnf or"></a>This script assumes that my.cnf file exists either in /etc/my.cnf or</h1><h1 id="/root/-my-cnf_and_has_groups__5Bmysqld_multi_5D_and__5BmysqldN_5D-_See_the"><a href="#/root/-my-cnf_and_has_groups__5Bmysqld_multi_5D_and__5BmysqldN_5D-_See_the" class="headerlink" title="/root/.my.cnf and has groups [mysqld_multi] and [mysqldN]. See the"></a>/root/.my.cnf and has groups [mysqld_multi] and [mysqldN]. See the</h1><h1 id="mysqld_multi_documentation_for_detailed_instructions"><a href="#mysqld_multi_documentation_for_detailed_instructions" class="headerlink" title="mysqld_multi documentation for detailed instructions."></a>mysqld_multi documentation for detailed instructions.</h1><p>#</p>
<h1 id="This_script_can_be_used_as_/etc/init-d/mysql-server"><a href="#This_script_can_be_used_as_/etc/init-d/mysql-server" class="headerlink" title="This script can be used as /etc/init.d/mysql.server"></a>This script can be used as /etc/init.d/mysql.server</h1><p>#</p>
<h1 id="Comments_to_support_chkconfig_on_RedHat_Linux"><a href="#Comments_to_support_chkconfig_on_RedHat_Linux" class="headerlink" title="Comments to support chkconfig on RedHat Linux"></a>Comments to support chkconfig on RedHat Linux</h1><h1 id="chkconfig_3A_2345_64_36"><a href="#chkconfig_3A_2345_64_36" class="headerlink" title="chkconfig: 2345 64 36"></a>chkconfig: 2345 64 36</h1><h1 id="description_3A_A_very_fast_and_reliable_SQL_database_engine"><a href="#description_3A_A_very_fast_and_reliable_SQL_database_engine" class="headerlink" title="description: A very fast and reliable SQL database engine."></a>description: A very fast and reliable SQL database engine.</h1><p>#</p>
<h1 id="Version_1-0"><a href="#Version_1-0" class="headerlink" title="Version 1.0"></a>Version 1.0</h1><p>#</p>
<p>basedir=/usr/local/mysql<br>bindir=/usr/local/mysql/bin</p>
<p>conf=$basedir/data/etc/my.cnf<br>export PATH=$PATH:$bindir</p>
<p>if test -x $bindir/mysqld_multi<br>then<br>  mysqld_multi=”$bindir/mysqld_multi”;<br>else<br>  echo “Can’t execute $bindir/mysqld_multi from dir $basedir”;<br>  exit;<br>fi</p>
<p>case “$1” in<br>    ‘start’ )<br>        “$mysqld_multi” –defaults-extra-file=$conf start $2<br>        ;;<br>    ‘stop’ )<br>        “$mysqld_multi” –defaults-extra-file=$conf stop $2<br>        ;;<br>    ‘report’ )<br>        “$mysqld_multi” –defaults-extra-file=$conf report $2<br>        ;;<br>    ‘restart’ )<br>        “$mysqld_multi” –defaults-extra-file=$conf stop $2<br>        “$mysqld_multi” –defaults-extra-file=$conf start $2<br>        ;;<br>    <em>)<br>        echo “Usage: $0 {start|stop|report|restart}” &gt;&amp;2<br>        ;;<br>esac<br><em>*Master OPS</em></em></p>
<p><pre class="lang:default decode:true ">mysql -uroot -S /usr/local/mysql/data/run/mysqld_3306.sock<br>mysql&gt; GRANT REPLICATION SLAVE ON <em>.</em> TO ‘repluser’@’localhost’ IDENTIFIED BY ‘suzf.net666’;<br>Query OK, 0 rows affected (0.00 sec)</pre><br><strong>Slave OPS</strong></p>
<p><pre class="lang:default decode:true">mysql -uroot -S /usr/local/mysql/data/run/mysqld_3307.sock<br>mysql&gt; CHANGE MASTER TO<br>    -&gt; MASTER_HOST=’localhost’,<br>    -&gt; MASTER_USER=’repluser’,<br>    -&gt; MASTER_PASSWORD=’suzf.net666’,<br>    -&gt; MASTER_PORT=3306,<br>    -&gt; MASTER_AUTO_POSITION = 1;<br>Query OK, 0 rows affected, 2 warnings (0.04 sec)<br>mysql&gt; start slave;<br>Query OK, 0 rows affected (0.19 sec)</pre><br>验证</p>
<p><a href="http://suzf.net/wp-content/uploads/2016/04/gtid1.png" target="_blank" rel="external"><img src="http://suzf.net/wp-content/uploads/2016/04/gtid1.png" alt="gtid1"></a></p>
<p>##### </p>
<p>&nbsp;</p>
<h5 id="u573A_u666F_u4E8C_uFF1A_u79FB_u9664_Replication"><a href="#u573A_u666F_u4E8C_uFF1A_u79FB_u9664_Replication" class="headerlink" title="场景二：移除  Replication"></a>场景二：移除  Replication</h5><p>首先关闭 SLAVE</p>
<p><pre class="lang:default decode:true">mysql&gt; STOP SLAVE;<br>Query OK, 0 rows affected (0.00 sec)</pre><br>使用ALL 参数 重置 SLAVE (MySQL &gt;= 5.6.7):</p>
<p><pre class="lang:default decode:true">mysql&gt; RESET SLAVE ALL;<br>Query OK, 0 rows affected (0.02 sec)</pre><br>此时 mysql replication 已经消失了</p>
<p><pre class="lang:default decode:true">mysql&gt; SHOW SLAVE STATUS\G<br>Empty set (0.00 sec)</pre><br>如果你希望这个SLAVE节点继续做一个新的MASTER的slave 节点，那么请设置 gtid_purged,你应该发出一下命令（即使 gtid_puerged 看起来是空的，你也应该重置一下MASTER.）</p>
<p><pre class="lang:default decode:true">mysql&gt; reset master;<br>Query OK, 0 rows affected (0.11 sec)</pre></p>
<p>mysql&gt; show variables like ‘%gtid%’;<br>+————————–+———–+<br>| Variable_name            | Value     |<br>+————————–+———–+<br>| enforce_gtid_consistency | ON        |<br>| gtid_executed            |           |<br>| gtid_mode                | ON        |<br>| gtid_next                | AUTOMATIC |<br>| gtid_owned               |           |<br>| gtid_purged              |           |<br>+————————–+———–+<br>6 rows in set (0.00 sec)<br>备注<br>我很确定我已经删除了 rely-binary-logs. (relay_log_basename variable)</p>
<p>&nbsp;</p>
<h5 id="u573A_u666F_u4E09_uFF1A_u62F7_u8D1D_u6570_u636E__u65B0_u5EFA_GTID_slave"><a href="#u573A_u666F_u4E09_uFF1A_u62F7_u8D1D_u6570_u636E__u65B0_u5EFA_GTID_slave" class="headerlink" title="场景三：拷贝数据 新建 GTID slave"></a>场景三：拷贝数据 新建 GTID slave</h5><h4 id="Using_mysqldump"><a href="#Using_mysqldump" class="headerlink" title="Using mysqldump"></a>Using mysqldump</h4><p>在 slave 几点初始化数据库</p>
<p><pre class="lang:default decode:true ">$ ./scripts/mysql_install_db –datadir=/usr/local/mysql/data/mysql_3307</pre><br>为了更简单使用 mysqldump, 是将下列参数加入配置文件</p>
<p><pre class="lang:default decode:true">[mysqldump]<br>quick<br>max_allowed_packet = 16M<br>port = 3306<br>socket = /usr/local/mysql/data/run/mysqld_3306.sock<br></pre><br>之后使用下面命令导出 Master 节点的 Cherry 数据库</p>
<p><pre class="lang:default decode:true">$ mysqldump –defaults-file=/usr/local/mysql/data/etc/my.cnf –user=root –password=<code>cat ~mysql/.root_password</code> –single-transaction –databases Cherry &gt; backup.sql<br>Warning: Using a password on the command line interface can be insecure.<br>Warning: A partial dump from a server that has GTIDs will by default include the GTIDs of all transactions, even those that changed suppressed parts of the database. If you don’t want to restore GTIDs, pass –set-gtid-purged=OFF. To make a complete dump, pass –all-databases –triggers –routines –events.</pre><br>备注<br>–defaults-file 参数必须放在第一个位置, 否则你将会入到一个我认为已经修复的<a href="http://bugs.mysql.com/bug.php?id=31312" target="_blank" rel="external"> bug</a>.</p>
<p>GTID 的诀窍在这里，当然它是通过 mysqldump 来实现的</p>
<p><pre class="lang:default decode:true">$grep -i gtid 、/tmp/backup.sql<br>– GTID state at the beginning of the backup<br>SET @@GLOBAL.GTID_PURGED=’770d3753-c6e4-11e2-8e78-080027d93e15:1-8’;</pre><br>之后将dump 文件传送到 slave 节点，然后导入它；</p>
<p><pre class="lang:default decode:true">mysql&gt; source /tmp/backup.sql;</pre><br>我最初得到了下面的错误：</p>
<p><pre class="lang:default decode:true">ERROR 1840 (HY000): @@GLOBAL.GTID_PURGED can only be set when @@GLOBAL.GTID_EXECUTED is empty.</pre><br>但是我的 gtid_executed 参数是空的:</p>
<p><pre class="lang:default decode:true">mysql&gt; show variables like ‘%gtid%’;<br>+————————–+——————————————+<br>| Variable_name            | Value                                    |<br>+————————–+——————————————+<br>| enforce_gtid_consistency | ON                                       |<br>| gtid_executed            |                                          |<br>| gtid_mode                | ON                                       |<br>| gtid_next                | AUTOMATIC                                |<br>| gtid_owned               |                                          |<br>| gtid_purged              | 770d3753-c6e4-11e2-8e78-080027d93e15:1-6 |<br>+————————–+——————————————+<br>6 rows in set (0.00 sec)</pre><br>错误消息显示冲突 一个<a href="http://bugs.mysql.com/bug.php?id=68038" target="_blank" rel="external">bug</a>已经打开。实际上，gtid_purged也必须是空的，以便能够设置它。<a href="http://dev.mysql.com/doc/refman/5.6/en/replication-options-gtids.html" target="_blank" rel="external">官方文档</a>中引用的唯一解决方法是使用下面的命令：</p>
<p><pre class="lang:default decode:true">mysql&gt; DROP DATABASE replicationdb;<br>Query OK, 1 row affected (0.07 sec)</pre></p>
<p>mysql&gt; RESET MASTER;<br>Query OK, 0 rows affected (0.06 sec)</p>
<p>mysql&gt; SHOW VARIABLES LIKE ‘%gtid%’;<br>+————————–+———–+<br>| Variable_name            | Value     |<br>+————————–+———–+<br>| enforce_gtid_consistency | ON        |<br>| gtid_executed            |           |<br>| gtid_mode                | ON        |<br>| gtid_next                | AUTOMATIC |<br>| gtid_owned               |           |<br>| gtid_purged              |           |<br>+————————–+———–+<br>6 rows in set (0.01 sec)<br><br>一旦完成你可以从新导入备份文件，如果最后没有错误出现，那么现在可以设置 replication 了。</p>
<p><pre class="lang:default decode:true">mysql&gt; change master to master_host=’lab.suzf.net’, master_port=3306, master_user=’repluser’, master_password=’suzf.net666’, master_auto_position=1;<br>Query OK, 0 rows affected, 2 warnings (0.16 sec)</pre></p>
<p>mysql&gt; start slave;<br>Query OK, 0 rows affected (0.03 sec)</p>
<p>mysql&gt; SHOW SLAVE STATUS\G<br><strong><strong><strong><strong><strong><strong><em>*</em></strong></strong></strong></strong></strong></strong> 1. row <strong><strong><strong><strong><strong><strong><em>*</em></strong></strong></strong></strong></strong></strong></p>
<pre><code>       Slave_IO_Running: Yes
      Slave_SQL_Running: Yes
          ... ...
Slave_SQL_Running_State: Slave has read all relay log; waiting for the slave I/O thread to update it&lt;/pre&gt;
</code></pre><p>如果使用的是mysql 5.5 可能会用到</p>
<p><pre class="lang:default decode:true">change master to master_host=’lab.suzf.net’, master_port=3306, master_user=’repluser’, master_password=’suzf.net666’,  master_log_file=’mysql-bin.000006’, master_log_pos=1026;</pre><br>从哪里可以获得 master_log_file 和 log_position（在你导入数据时请不要将 master 设置为 read-only ）</p>
<p><pre class="lang:default decode:true ">mysql&gt; FLUSH TABLES WITH READ LOCK;<br>mysql&gt; SHOW MASTER STATUS;</pre><br>&nbsp;</p>
<h4 id="Using_XtraBackup"><a href="#Using_XtraBackup" class="headerlink" title="Using XtraBackup"></a>Using XtraBackup</h4><p>准备工作</p>
<p><pre class="lang:default decode:true ">$mkdir  /opt/data/backup/mysql -p<br>$ cat 3306.cnf<br>[mysqld]<br>socket = /usr/local/mysql/data/run/mysqld_3306.sock<br>port = 3306<br>pid-file = /usr/local/mysql/data/run/mysqld_3306.pid<br>datadir = /usr/local/mysql/data/mysql_3306</pre></p>
<h1 id="set_for_GTID_Replication-2"><a href="#set_for_GTID_Replication-2" class="headerlink" title="set for GTID Replication"></a>set for GTID Replication</h1><p>server_id = 3232237894<br>gtid_mode = on<br>enforce_gtid_consistency = on</p>
<h1 id="binlog-1"><a href="#binlog-1" class="headerlink" title="binlog"></a>binlog</h1><p>log-bin = /usr/local/mysql/data/binlogs/master-binlog<br>log-slave-updates = 1<br>binlog_format = row</p>
<h1 id="rely_log-2"><a href="#rely_log-2" class="headerlink" title="rely log"></a>rely log</h1><p>skip_slave_start=1</p>
<p>[client]<br>default-character-set = utf8</p>
<p>$ cat 3307.cnf<br>[mysqld]<br>socket = /usr/local/mysql/data/run/mysqld_3307.sock<br>port = 3307<br>pid-file = /usr/local/mysql/data/run/mysqld_3307.pid<br>datadir = /usr/local/mysql/data/mysql_3307</p>
<h1 id="set_for_GTID_Replication-3"><a href="#set_for_GTID_Replication-3" class="headerlink" title="set for GTID Replication"></a>set for GTID Replication</h1><p>server_id = 3232237866<br>gtid_mode = on<br>enforce_gtid_consistency = on</p>
<h1 id="bin_log-1"><a href="#bin_log-1" class="headerlink" title="bin log"></a>bin log</h1><p>log-bin = /usr/local/mysql/data/binlogs/slave-binlog<br>log-slave-updates = 1<br>binlog_format = row</p>
<h1 id="rely_log-3"><a href="#rely_log-3" class="headerlink" title="rely log"></a>rely log</h1><p>skip_slave_start=1</p>
<p>[client]<br>default-character-set = utf8<br>我们将使用下面命令完整数据库备份：</p>
<p><pre class="lang:default decode:true">$innobackupex –defaults-file=/opt/data/backup/mysql/3306.cnf –user=root  –socket=/usr/local/mysql/data/run/mysqld_3306.sock  /tmp</pre><br><a href="http://suzf.net/wp-content/uploads/2016/04/innobackup.png" target="_blank" rel="external"><img src="http://suzf.net/wp-content/uploads/2016/04/innobackup.png" alt="innobackup"></a></p>
<p>这里要注意的重要的文件是在xtrabackup_binlog_info</p>
<p><pre class="lang:default decode:true ">$ cat /tmp/2016-04-05_15-26-40/xtrabackup_binlog_info<br>master-binlog.000006  191 81ee72fe-c957-11e5-ae70-0800272aa66e:1-12</pre><br>在 Slave 节点恢复数据</p>
<p><pre class="lang:default decode:true ">$ innobackupex –defaults-file=/opt/data/backup/mysql/3307.cnf –user=root  –copy-back /tmp/2016-04-05_15-26-40</pre><br>备注<br>Original data directory must be empty!<br>即 Slave 节点数据目录必须为空</p>
<p>权限修复 启动实例</p>
<p><pre class="lang:default decode:true ">$ chown -R mysql:mysql  /usr/local/mysql/data/mysql_3307<br>$ /etc/init.d/mysqld_multi.server start 3307<br>$ /etc/init.d/mysqld_multi.server report<br>Reporting MySQL servers<br>MySQL server from group: mysqld3306 is running<br>MySQL server from group: mysqld3307 is running</pre><br>你需要先设置 gtid_purged 然后再创建 replication，在 <a href="https://www.percona.com/doc/percona-xtrabackup/2.1/howtos/recipes_ibkx_gtid.html" target="_blank" rel="external">Percona 文档 </a>中有说明</p>
<p><pre class="lang:default decode:true ">mysql&gt;  SET GLOBAL gtid_purged=”81ee72fe-c957-11e5-ae70-0800272aa66e:1-12”;<br>ERROR 1840 (HY000): @@GLOBAL.GTID_PURGED can only be set when @@GLOBAL.GTID_EXECUTED is empty.</pre></p>
<h1 id="u51FA_u73B0_u4E0A_u9762_u4E2A_u9519_u8BEF__u6267_u884C_u4E0B_u9762_u64CD_u4F5C"><a href="#u51FA_u73B0_u4E0A_u9762_u4E2A_u9519_u8BEF__u6267_u884C_u4E0B_u9762_u64CD_u4F5C" class="headerlink" title="出现上面个错误 执行下面操作"></a>出现上面个错误 执行下面操作</h1><p>mysql&gt; reset master;<br>Query OK, 0 rows affected (0.02 sec)</p>
<p>mysql&gt;  SET GLOBAL gtid_purged=”81ee72fe-c957-11e5-ae70-0800272aa66e:1-12”;<br>Query OK, 0 rows affected (0.05 sec)</p>
<p>mysql&gt; CHANGE MASTER TO<br>    -&gt; MASTER_HOST=’localhost’,<br>    -&gt; MASTER_USER=’repluser’,<br>    -&gt; MASTER_PASSWORD=’suzf.net666’,<br>    -&gt; MASTER_PORT=3306,<br>    -&gt; MASTER_AUTO_POSITION = 1;<br>Query OK, 0 rows affected, 2 warnings (0.06 sec)</p>
<p>mysql&gt; SHOW WARNINGS;<br>+——-+——+————————————————————————————————————————————————————————————————————————————————————————————–+<br>| Level | Code | Message                                                                                                                                                                                                                                                                              |<br>+——-+——+————————————————————————————————————————————————————————————————————————————————————————————–+<br>| Note  | 1759 | Sending passwords in plain text without SSL/TLS is extremely insecure.                                                                                                                                                                                                               |<br>| Note  | 1760 | Storing MySQL user name or password information in the master info repository is not secure and is therefore not recommended. Please consider using the USER and PASSWORD connection options for START SLAVE; see the ‘START SLAVE Syntax’ in the MySQL Manual for more information. |<br>+——-+——+————————————————————————————————————————————————————————————————————————————————————————————–+<br>2 rows in set (0.00 sec)<br>在经典的复制中（MySQL的5.5及以下）命令应该是这样的：</p>
<p><pre class="lang:default decode:true ">change master to master_host=’lab.suzf.net’, master_port=3306, master_user=’repluser’, master_password=’suzf.net666’,  master_log_file=’mysql-bin.000006’, master_log_pos=1026;</pre><br>启动 slave 查看状态</p>
<p><pre class="lang:default decode:true ">mysql&gt; start slave;<br>Query OK, 0 rows affected (0.01 sec)</pre></p>
<p>mysql&gt; show slave status\G<br>             Slave_IO_Running: Yes<br>            Slave_SQL_Running: Yes<br>      Slave_SQL_Running_State: Slave has read all relay log; waiting for the slave I/O thread to update it<br>           Retrieved_Gtid_Set: 81ee72fe-c957-11e5-ae70-0800272aa66e:13<br>            Executed_Gtid_Set: 81ee72fe-c957-11e5-ae70-0800272aa66e:1-13<br>                Auto_Position: 1<br>&nbsp;</p>
<p>&nbsp;</p>
<h5 id="u573A_u666F_u56DB_uFF1A_u7ECF_u5178_u590D_u5236__u2013_26gt_3B_GTID_Replication"><a href="#u573A_u666F_u56DB_uFF1A_u7ECF_u5178_u590D_u5236__u2013_26gt_3B_GTID_Replication" class="headerlink" title="场景四：经典复制 –&gt; GTID Replication"></a>场景四：经典复制 –&gt; GTID Replication</h5><p>a. 按场景一中描述配置参数文件<br>b. 所有服务器设置global.read_only参数，等待主从服务器同步完毕；<br>mysql&gt; SET @@global.read_only = ON;<br>c. 依次重启主从服务器；<br>d. 使用change master 更新主从配置；<br>mysql&gt; CHANGE MASTER TO<br>&gt; MASTER_HOST = host,<br>&gt; MASTER_PORT = port,<br>&gt; MASTER_USER = user,<br>&gt; MASTER_PASSWORD = password,<br>&gt; MASTER_AUTO_POSITION = 1;<br>e. 从库开启复制<br>mysql&gt; START SLAVE;<br>f. 验证主从复制</p>
<p>##### </p>
<h3 id="FAQ"><a href="#FAQ" class="headerlink" title="FAQ"></a>FAQ</h3><h3 id="Skip_counter_with_GTID"><a href="#Skip_counter_with_GTID" class="headerlink" title="Skip counter with GTID"></a>Skip counter with GTID</h3><p><pre class="lang:default decode:true mysql ">mysql&gt; show slave status\G<br><strong><strong><strong><strong><strong><strong><em>*</em></strong></strong></strong></strong></strong></strong> 1. row <strong><strong><strong><strong><strong><strong><em>*</em></strong></strong></strong></strong></strong></strong><br>           Retrieved_Gtid_Set: 770d3753-c6e4-11e2-8e78-080027d93e15:1-9<br>            Executed_Gtid_Set: 770d3753-c6e4-11e2-8e78-080027d93e15:1-7,<br>97e23f6a-cc52-11e2-b1e1-08002776e125:1-2<br>                Auto_Position: 1<br>1 row in set (0.00 sec)</pre><br>从上面我们可以猜测到 事务执行到 事务ID 8 可能出现错误，接下来我们需要注入相同的空事务ID。</p>
<p><pre class="lang:default decode:true mysql">mysql&gt; stop slave;<br>Query OK, 0 rows affected (0.00 sec)</pre></p>
<p>mysql&gt; show variables like ‘%gtid%’;<br>+————————–+———–+<br>| Variable_name            | Value     |<br>+————————–+———–+<br>| enforce_gtid_consistency | ON        |<br>| gtid_executed            |           |<br>| gtid_mode                | ON        |<br>| gtid_next                | AUTOMATIC |<br>| gtid_owned               |           |<br>| gtid_purged              |           |<br>+————————–+———–+<br>6 rows in set (0.00 sec)</p>
<p>mysql&gt; set gtid_next=’770d3753-c6e4-11e2-8e78-080027d93e15:8’;<br>Query OK, 0 rows affected (0.00 sec)</p>
<p>mysql&gt; begin;<br>Query OK, 0 rows affected (0.00 sec)</p>
<p>mysql&gt; commit;<br>Query OK, 0 rows affected (0.00 sec)</p>
<p>mysql&gt; set gtid_next=’AUTOMATIC’;<br>Query OK, 0 rows affected (0.00 sec)</p>
<p>mysql&gt; start slave;<br>Query OK, 0 rows affected (0.00 sec)<br>&nbsp;</p>
<p>Reference : <a href="https://dev.mysql.com/doc/refman/5.6/en/replication-gtids.html" target="_blank" rel="external">Mysql manual</a></p>
<p>&nbsp;</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://blog.suzf.net/2016/04/01/How-to_setup_gtid_on_replication/" data-id="ciqcd6lyn00cvclo91owxkph7" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/GTID/">GTID</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Mysql/">Mysql</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2016/04/03/pip_faq_-_Cannot_fetch_index_base_URL/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          pip_faq - Cannot fetch index base URL
        
      </div>
    </a>
  
  
    <a href="/2016/04/01/Mysql_GTID_简述/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Mysql GTID 简述</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Apache/">Apache</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Auto-ops/">Auto ops</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/CouchBase/">CouchBase</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/HA/">HA</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Hadoop/">Hadoop</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Hardware/">Hardware</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Highcharts/">Highcharts</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/LVS/">LVS</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Life/">Life</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux/">Linux</a><span class="category-list-count">28</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/MongoDB/">MongoDB</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Mysql/">Mysql</a><span class="category-list-count">10</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Nginx/">Nginx</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Oracle/">Oracle</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/PHP/">PHP</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Puppet/">Puppet</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/">Python</a><span class="category-list-count">23</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Redis/">Redis</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Shell/">Shell</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Tomcat/">Tomcat</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Web/">Web</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Zabbix/">Zabbix</a><span class="category-list-count">13</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Apache/">Apache</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CMD/">CMD</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Ceph/">Ceph</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Debian/">Debian</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ELK/">ELK</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Exsi/">Exsi</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Flask/">Flask</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GTID/">GTID</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Kernel/">Kernel</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Kickstart/">Kickstart</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/LB/">LB</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/LVS/">LVS</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Life/">Life</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/">Linux</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Lnmp/">Lnmp</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Log/">Log</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MongoDB/">MongoDB</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mysql/">Mysql</a><span class="tag-list-count">15</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Nginx/">Nginx</a><span class="tag-list-count">8</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NoSQL/">NoSQL</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Oracle/">Oracle</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PHP/">PHP</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Proxy/">Proxy</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Puppet/">Puppet</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Python/">Python</a><span class="tag-list-count">23</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RAC/">RAC</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Re/">Re</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ZK/">ZK</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Zabbix/">Zabbix</a><span class="tag-list-count">13</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/bug/">bug</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/code/">code</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/coredump/">coredump</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/couchbase/">couchbase</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/debug/">debug</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/diy/">diy</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/elasticsearch/">elasticsearch</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/expect/">expect</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/facter/">facter</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/faq/">faq</a><span class="tag-list-count">9</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hadoop/">hadoop</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/highcharts/">highcharts</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/idrac/">idrac</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/iso/">iso</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kafka/">kafka</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/lvm/">lvm</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pip/">pip</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/redis/">redis</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/rewrite/">rewrite</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/rsync/">rsync</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/rsyslog/">rsyslog</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/snmp/">snmp</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/strace/">strace</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sudo/">sudo</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tcpdump/">tcpdump</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tomcat/">tomcat</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vim/">vim</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web/">web</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/wiki/">wiki</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/zookeeper/">zookeeper</a><span class="tag-list-count">4</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Apache/" style="font-size: 10px;">Apache</a> <a href="/tags/CMD/" style="font-size: 10px;">CMD</a> <a href="/tags/Ceph/" style="font-size: 10.91px;">Ceph</a> <a href="/tags/Debian/" style="font-size: 10px;">Debian</a> <a href="/tags/ELK/" style="font-size: 10px;">ELK</a> <a href="/tags/Exsi/" style="font-size: 10px;">Exsi</a> <a href="/tags/Flask/" style="font-size: 10px;">Flask</a> <a href="/tags/GTID/" style="font-size: 10.91px;">GTID</a> <a href="/tags/Kernel/" style="font-size: 10.91px;">Kernel</a> <a href="/tags/Kickstart/" style="font-size: 10px;">Kickstart</a> <a href="/tags/LB/" style="font-size: 10px;">LB</a> <a href="/tags/LVS/" style="font-size: 10px;">LVS</a> <a href="/tags/Life/" style="font-size: 10px;">Life</a> <a href="/tags/Linux/" style="font-size: 10px;">Linux</a> <a href="/tags/Lnmp/" style="font-size: 10px;">Lnmp</a> <a href="/tags/Log/" style="font-size: 10px;">Log</a> <a href="/tags/MongoDB/" style="font-size: 11.82px;">MongoDB</a> <a href="/tags/Mysql/" style="font-size: 19.09px;">Mysql</a> <a href="/tags/Nginx/" style="font-size: 16.36px;">Nginx</a> <a href="/tags/NoSQL/" style="font-size: 12.73px;">NoSQL</a> <a href="/tags/Oracle/" style="font-size: 11.82px;">Oracle</a> <a href="/tags/PHP/" style="font-size: 10.91px;">PHP</a> <a href="/tags/Proxy/" style="font-size: 10px;">Proxy</a> <a href="/tags/Puppet/" style="font-size: 14.55px;">Puppet</a> <a href="/tags/Python/" style="font-size: 20px;">Python</a> <a href="/tags/RAC/" style="font-size: 10.91px;">RAC</a> <a href="/tags/Re/" style="font-size: 11.82px;">Re</a> <a href="/tags/ZK/" style="font-size: 10px;">ZK</a> <a href="/tags/Zabbix/" style="font-size: 18.18px;">Zabbix</a> <a href="/tags/bug/" style="font-size: 10px;">bug</a> <a href="/tags/code/" style="font-size: 10px;">code</a> <a href="/tags/coredump/" style="font-size: 10px;">coredump</a> <a href="/tags/couchbase/" style="font-size: 10px;">couchbase</a> <a href="/tags/debug/" style="font-size: 10px;">debug</a> <a href="/tags/diy/" style="font-size: 10px;">diy</a> <a href="/tags/elasticsearch/" style="font-size: 10px;">elasticsearch</a> <a href="/tags/expect/" style="font-size: 10px;">expect</a> <a href="/tags/facter/" style="font-size: 10px;">facter</a> <a href="/tags/faq/" style="font-size: 17.27px;">faq</a> <a href="/tags/hadoop/" style="font-size: 10px;">hadoop</a> <a href="/tags/highcharts/" style="font-size: 10px;">highcharts</a> <a href="/tags/idrac/" style="font-size: 10px;">idrac</a> <a href="/tags/iso/" style="font-size: 10px;">iso</a> <a href="/tags/kafka/" style="font-size: 10px;">kafka</a> <a href="/tags/lvm/" style="font-size: 10px;">lvm</a> <a href="/tags/pip/" style="font-size: 12.73px;">pip</a> <a href="/tags/redis/" style="font-size: 15.45px;">redis</a> <a href="/tags/rewrite/" style="font-size: 10px;">rewrite</a> <a href="/tags/rsync/" style="font-size: 10px;">rsync</a> <a href="/tags/rsyslog/" style="font-size: 10px;">rsyslog</a> <a href="/tags/snmp/" style="font-size: 10px;">snmp</a> <a href="/tags/strace/" style="font-size: 10px;">strace</a> <a href="/tags/sudo/" style="font-size: 10px;">sudo</a> <a href="/tags/tcpdump/" style="font-size: 10px;">tcpdump</a> <a href="/tags/tomcat/" style="font-size: 13.64px;">tomcat</a> <a href="/tags/vim/" style="font-size: 10.91px;">vim</a> <a href="/tags/web/" style="font-size: 12.73px;">web</a> <a href="/tags/wiki/" style="font-size: 10px;">wiki</a> <a href="/tags/zookeeper/" style="font-size: 12.73px;">zookeeper</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">May 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">April 2016</a><span class="archive-list-count">13</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">March 2016</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/02/">February 2016</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01/">January 2016</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/12/">December 2015</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/11/">November 2015</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/10/">October 2015</a><span class="archive-list-count">12</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/08/">August 2015</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/07/">July 2015</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/06/">June 2015</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/05/">May 2015</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/03/">March 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/12/">December 2014</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/11/">November 2014</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/10/">October 2014</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/09/">September 2014</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/08/">August 2014</a><span class="archive-list-count">14</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/07/">July 2014</a><span class="archive-list-count">10</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2016/05/12/839/">Linux 下使用 strace 诊断疑难杂症</a>
          </li>
        
          <li>
            <a href="/2016/04/27/MySQL_mysqldump_数据导出详解/">MySQL mysqldump 数据导出详解</a>
          </li>
        
          <li>
            <a href="/2016/04/24/Python_Re_module_learn/">Python Re module learn</a>
          </li>
        
          <li>
            <a href="/2016/04/22/Python正则表达式操作指南/">Python正则表达式操作指南</a>
          </li>
        
          <li>
            <a href="/2016/04/18/Hello_Kafka/">Hello Kafka</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2016 Jeffrey Su<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
  <script src="/fancybox/jquery.fancybox.pack.js" type="text/javascript"></script>


<script src="/js/script.js" type="text/javascript"></script>

  </div>
</body>
</html>